(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{NXEf:function(t,e,n){},"g/6l":function(t,e,n){"use strict";n.r(e);var s=n("sk9p"),i=n.n(s),a=n("QbLZ"),o=n.n(a),r=n("Lku0"),l=n("Mm0z"),c=n("L2JU"),u=n("Aozi"),d=n("wd/R"),v=n.n(d),h=new u.a,m={data:function(){return{dateFrom:null,dateTo:null,dateFormatted:null,selected:[],processing:!1,info:{showMsg:!1,color:"success",message:""}}},components:{VDatePicker:r.a,VMenu:l.a},computed:o()({computedDateFrom:function(){return this.formatDate(this.dateFrom)}},Object(c.b)({currencies:"allCurrenciesWithRates",mainCurrency:"sysCurrency"})),watch:{date:function(t){this.dateFormatted=this.formatDate(this.date)}},beforeMount:function(){var t=this;this.$store.state.title="Load rates",this.$store.commit("setupToolbarMenu",{mainAction:{title:"close",icon:"reply",action:function(){t.$router.push({path:"/currencies"})}}}),this.$store.dispatch("getSettings"),this.$store.dispatch("getAllCurrenciesWithRates"),this.dateTo=v()().format("YYYY-MM-DD")},methods:{toggle:function(t){var e=this.selected.findIndex(function(e){return e.id==t.id});-1==e?this.selected.push(t):this.selected.splice(e,1)},isSelected:function(t){return-1!=this.selected.findIndex(function(e){return e.id==t.id})},formatDate:function(t){if(!t)return null;var e=t.split("-"),n=i()(e,3);return n[0]+"-"+n[1]+"-"+n[2]},parseDate:function(t){if(!t)return null;var e=t.split("-"),n=i()(e,3),s=n[0],a=n[1];return n[2]+"-"+s.padStart(2,"0")+"-"+a.padStart(2,"0")},load:function(){var t=this;if(0!=this.selected.length&&null!=this.dateFrom&&null!=this.dateTo){var e=[];this.selected.forEach(function(t){e.push(t.id)}),this.processing=!0,h.post("/api/tools/loadrates",{dateFrom:this.dateFrom,dateTo:this.dateTo,currencies:e}).then(function(e){t.processing=!1,t.$store.dispatch("getAllCurrenciesWithRates"),t.showMessage(!0,"Rates was loaded successfully")}).catch(function(e){t.processing=!1,t.showMessage(!0,"Error occurred! Try again!")})}},showMessage:function(t,e){this.info.color=!0===t?"success":"error",this.info.message=e,this.info.showMsg=!0}}},f=(n("xKRp"),n("KHd+")),p=n("ZUTo"),g=n.n(p),_=n("gzZi"),x=n("rHzn"),w=n("pSOK"),b=n("zn5u"),k=n("Do8S"),T=n("pyJu"),y=n("iGBT"),V=n("upUY"),F=n("QP5J"),M=n("XSMC"),L=n("5Emp"),C=n("jjY0"),D=n("LbRV"),S=n("Jnd4"),R=Object(f.a)(m,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",[n("v-layout",{attrs:{row:""}},[n("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[n("div",{staticClass:"table-wrapper"},[n("v-layout",{attrs:{row:"","mx-2":""}},[n("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[n("v-menu",{attrs:{"close-on-content-click":!0,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","max-width":"290px","min-width":"290px"}},[n("v-text-field",{attrs:{slot:"activator",label:"Begin date","persistent-hint":"","prepend-icon":"event"},on:{blur:function(e){t.dateFrom=t.parseDate(t.dateFormatted)}},slot:"activator",model:{value:t.dateFrom,callback:function(e){t.dateFrom=e},expression:"dateFrom"}}),t._v(" "),n("v-date-picker",{attrs:{"no-title":""},on:{input:function(e){t.menu1=!1}},model:{value:t.dateFrom,callback:function(e){t.dateFrom=e},expression:"dateFrom"}})],1)],1),t._v(" "),n("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[n("v-menu",{attrs:{"close-on-content-click":!0,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","max-width":"290px","min-width":"290px"}},[n("v-text-field",{attrs:{slot:"activator",label:"End date","persistent-hint":"","prepend-icon":"event"},on:{blur:function(e){t.dateTo=t.parseDate(t.dateFormatted)}},slot:"activator",model:{value:t.dateTo,callback:function(e){t.dateTo=e},expression:"dateTo"}}),t._v(" "),n("v-date-picker",{attrs:{"no-title":""},on:{input:function(e){t.menu1=!1}},model:{value:t.dateTo,callback:function(e){t.dateTo=e},expression:"dateTo"}})],1)],1)],1),t._v(" "),n("v-layout",{attrs:{row:"","mx-2":""}},[n("v-btn",{attrs:{color:"appColor",dark:"",block:"",disabled:!0===this.processing},on:{click:t.load}},[t._v("Load rates\n                    ")])],1),t._v(" "),n("v-progress-linear",{directives:[{name:"show",rawName:"v-show",value:t.processing,expression:"processing"}],attrs:{indeterminate:!0}}),t._v(" "),n("v-layout",{attrs:{row:"","mx-2":""}},[n("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[n("v-list",{attrs:{"two-line":""}},[t._l(t.currencies,function(e,s){return[n("v-list-tile",{key:e.id,attrs:{avatar:"",ripple:""},on:{click:function(n){return t.toggle(e)}}},[n("v-list-tile-content",[n("v-list-tile-title",[t._v(t._s(e.short_name)+"\n                                        ")]),t._v(" "),n("v-list-tile-sub-title",[t._v(t._s(e.name)+"\n                                        ")])],1),t._v(" "),n("v-list-tile-action",[null==e.rate?n("v-list-tile-action-text",[t._v("The rate isn't loaded\n                                        ")]):t._e(),t._v(" "),null!==e.rate&&1==e.mult?n("v-list-tile-action-text",[t._v(t._s(e.rate)+" "+t._s(t.mainCurrency.short_name)+"\n                                        ")]):t._e(),t._v(" "),null!==e.rate&&e.mult>1?n("v-list-tile-action-text",[t._v(t._s(e.rate)+" "+t._s(t.mainCurrency.short_name)+" for "+t._s(e.mult)+"\n                                            "+t._s(e.short_name)+"\n                                        ")]):t._e(),t._v(" "),n("v-list-tile-action",[n("v-checkbox",{attrs:{"input-value":t.isSelected(e),primary:"","hide-details":""}})],1)],1)],1),t._v(" "),s+1<t.currencies.length?n("v-divider",{key:s}):t._e()]})],2)],1)],1)],1)]),t._v(" "),n("v-snackbar",{attrs:{color:t.info.color,timeout:2e3},model:{value:t.info.showMsg,callback:function(e){t.$set(t.info,"showMsg",e)},expression:"info.showMsg"}},[t._v("\n            "+t._s(t.info.message)+"\n            "),n("v-btn",{attrs:{dark:"",flat:""},on:{click:function(e){t.info.showMsg=!1}}},[t._v("\n                Close\n            ")])],1)],1)],1)},[],!1,null,"55397fb7",null);e.default=R.exports;g()(R,{VBtn:_.a,VCheckbox:x.a,VContainer:w.a,VDatePicker:r.a,VDivider:b.a,VFlex:k.a,VLayout:T.a,VList:y.a,VListTile:V.a,VListTileAction:F.a,VListTileActionText:M.a,VListTileContent:M.b,VListTileSubTitle:M.c,VListTileTitle:M.d,VMenu:L.a,VProgressLinear:C.a,VSnackbar:D.a,VTextField:S.a})},xKRp:function(t,e,n){"use strict";var s=n("NXEf");n.n(s).a}}]);