webpackJsonp([0],{"0TQ1":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("d7EF"),a=n.n(r),i=n("Dd8w"),o=n.n(i),s=n("NYxO"),l=n("0uDD"),c=n("PJh5"),u=new l.a,d={data:function(){return{dateFrom:null,dateTo:null,dateFormatted:null,selected:[],processing:!1}},computed:o()({computedDateFrom:function(){return this.formatDate(this.dateFrom)}},Object(s.b)({currencies:"allCurrenciesWithRates",mainCurrency:"sysCurrency"})),watch:{date:function(t){this.dateFormatted=this.formatDate(this.date)}},beforeMount:function(){var t=this;this.$store.state.title="Load rates",this.$store.commit("setupToolbarMenu",{mainAction:{title:"close",icon:"reply",action:function(){t.$router.push({path:"/currencies"})}}}),this.$store.dispatch("getSettings"),this.$store.dispatch("getAllCurrenciesWithRates"),this.dateTo=c().format("YYYY-MM-DD")},methods:{toggle:function(t){var e=this.selected.findIndex(function(e){return e.id==t.id});-1==e?this.selected.push(t):this.selected.splice(e,1)},isSelected:function(t){return-1!=this.selected.findIndex(function(e){return e.id==t.id})},formatDate:function(t){if(!t)return null;var e=t.split("-"),n=a()(e,3);return n[0]+"-"+n[1]+"-"+n[2]},parseDate:function(t){if(!t)return null;var e=t.split("-"),n=a()(e,3),r=n[0],i=n[1];return n[2]+"-"+r.padStart(2,"0")+"-"+i.padStart(2,"0")},load:function(){var t=this;if(0!=this.selected.length&&null!=this.dateFrom&&null!=this.dateTo){var e=[];this.selected.forEach(function(t){e.push(t.id)}),u.post("/api/tools/loadrates",{dateFrom:this.dateFrom,dateTo:this.dateTo,currencies:e}).then(function(e){t.processing=!1,t.$store.dispatch("getAllCurrenciesWithRates")}).catch(function(e){t.processing=!1,alert("error")})}}}},v={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",[n("v-layout",{attrs:{row:""}},[n("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[n("div",{staticClass:"table-wrapper"},[n("v-layout",{attrs:{row:"","mx-2":""}},[n("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[n("v-menu",{attrs:{"close-on-content-click":!0,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","max-width":"290px","min-width":"290px"}},[n("v-text-field",{attrs:{slot:"activator",label:"Begin date","persistent-hint":"","prepend-icon":"event"},on:{blur:function(e){t.dateFrom=t.parseDate(t.dateFormatted)}},slot:"activator",model:{value:t.dateFrom,callback:function(e){t.dateFrom=e},expression:"dateFrom"}}),t._v(" "),n("v-date-picker",{attrs:{"no-title":""},on:{input:function(e){t.menu1=!1}},model:{value:t.dateFrom,callback:function(e){t.dateFrom=e},expression:"dateFrom"}})],1)],1),t._v(" "),n("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[n("v-menu",{attrs:{"close-on-content-click":!0,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","max-width":"290px","min-width":"290px"}},[n("v-text-field",{attrs:{slot:"activator",label:"End date","persistent-hint":"","prepend-icon":"event"},on:{blur:function(e){t.dateTo=t.parseDate(t.dateFormatted)}},slot:"activator",model:{value:t.dateTo,callback:function(e){t.dateTo=e},expression:"dateTo"}}),t._v(" "),n("v-date-picker",{attrs:{"no-title":""},on:{input:function(e){t.menu1=!1}},model:{value:t.dateTo,callback:function(e){t.dateTo=e},expression:"dateTo"}})],1)],1)],1),t._v(" "),n("v-layout",{attrs:{row:"","mx-2":""}},[n("v-btn",{attrs:{color:"appColor",dark:"",block:"",disabled:!0===this.processing},on:{click:t.load}},[t._v("Load rates\n                    ")])],1),t._v(" "),n("v-progress-linear",{directives:[{name:"show",rawName:"v-show",value:t.processing,expression:"processing"}],attrs:{indeterminate:!0}}),t._v(" "),n("v-layout",{attrs:{row:"","mx-2":""}},[n("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[n("v-list",{attrs:{"two-line":""}},[t._l(t.currencies,function(e,r){return[n("v-list-tile",{key:e.short_name,attrs:{avatar:"",ripple:""},on:{click:function(n){return t.toggle(e)}}},[n("v-list-tile-content",[n("v-list-tile-title",[t._v(t._s(e.short_name)+"\n                                        ")]),t._v(" "),n("v-list-tile-sub-title",[t._v(t._s(e.name)+"\n                                        ")])],1),t._v(" "),n("v-list-tile-action",[null==e.rate?n("v-list-tile-action-text",[t._v("The rate isn't loaded\n                                        ")]):t._e(),t._v(" "),null!==e.rate&&1==e.mult?n("v-list-tile-action-text",[t._v(t._s(e.rate)+" "+t._s(t.mainCurrency.short_name)+"\n                                        ")]):t._e(),t._v(" "),null!==e.rate&&e.mult>1?n("v-list-tile-action-text",[t._v(t._s(e.rate)+" "+t._s(t.mainCurrency.short_name)+" for "+t._s(e.mult)+"\n                                            "+t._s(e.short_name)+"\n                                        ")]):t._e(),t._v(" "),n("v-list-tile-action",[n("v-checkbox",{attrs:{"input-value":t.isSelected(e),primary:"","hide-details":""}})],1)],1)],1),t._v(" "),r+1<t.currencies.length?n("v-divider",{key:r}):t._e()]})],2)],1)],1)],1)])],1)],1)},staticRenderFns:[]};var f=n("VU/8")(d,v,!1,function(t){n("k5dH")},"data-v-c974884a",null);e.default=f.exports},"5PlU":function(t,e,n){var r=n("RY/4"),a=n("dSzd")("iterator"),i=n("/bQp");t.exports=n("FeBl").isIterable=function(t){var e=Object(t);return void 0!==e[a]||"@@iterator"in e||i.hasOwnProperty(r(e))}},Xd32:function(t,e,n){n("+tPU"),n("zQR9"),t.exports=n("5PlU")},d7EF:function(t,e,n){"use strict";e.__esModule=!0;var r=i(n("us/S")),a=i(n("BO1k"));function i(t){return t&&t.__esModule?t:{default:t}}e.default=function(){return function(t,e){if(Array.isArray(t))return t;if((0,r.default)(Object(t)))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var s,l=(0,a.default)(t);!(r=(s=l.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&l.return&&l.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},k5dH:function(t,e){},"us/S":function(t,e,n){t.exports={default:n("Xd32"),__esModule:!0}}});
//# sourceMappingURL=loadrates.afb841f59f04ef580243.js.map